(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{192:function(e,t,n){e.exports=n(347)},202:function(e,t,n){},203:function(e,t,n){},204:function(e,t,n){},205:function(e,t,n){},206:function(e,t,n){},323:function(e,t,n){},324:function(e,t,n){},326:function(e,t,n){},327:function(e,t,n){},344:function(e,t,n){},347:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(41),c=n.n(o),u=n(40),i=n(27),s=(n(201),n(30)),l=n(20),E=function(e){return{type:"CHANGE_USERNAME_TEXT",text:e}},f=function(e){return{type:"CHANGE_PASSWORD_TEXT",text:e}},m=function(e){return{type:"FETCH_LOGIN_SUCCESS",data:e}},g=function(e){return{type:"FETCH_LOGIN_FAILURE",errorMsg:e}},b=function(e){return{type:"FETCH_NEWS_FAILURE",errorMsg:e}},d={activePage:"/"},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_ACTIVE_PAGE":return Object(l.a)({},e,{activePage:t.page});default:return e}},h={INIT:"INIT",SUCCESS:"SUCCESS",FAILURE:"FAILURE",REQUEST:"REQUEST",ERROR:"ERROR"},O=a.a.createContext(),v=O.Provider,j=O.Consumer,C=a.a.createContext(),S=C.Provider,w=C.Consumer,T={userNameText:"",passwordText:"",status:h.INIT,isLoggedIn:!1,errorMsg:null},y=function(e,t){return null===t?e(0,e.length-1):e+t},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.text,a=t.errorMsg,o=e.userNameText,c=e.passwordText;switch(n){case"CHANGE_USERNAME_TEXT":return Object(l.a)({},e,{userNameText:y(o,r)});case"CHANGE_PASSWORD_TEXT":return Object(l.a)({},e,{passwordText:y(c,r)});case"FETCH_LOGIN_REQUEST":return Object(l.a)({},e,{status:h.REQUEST,errorMsg:null});case"FETCH_LOGIN_SUCCESS":return Object(l.a)({},e,{status:h.SUCCESS,userNameText:"",passwordText:"",isLoggedIn:!0,errorMsg:null});case"FETCH_LOGIN_FAILURE":return Object(l.a)({},e,{status:h.FAILURE,errorMsg:a,userNameText:"",passwordText:""});case"LOGOUT":return Object(l.a)({},e,{status:h.INIT,isLoggedIn:!1});default:return e}},_={news:[],status:h.INIT,errorMsg:null},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.news,a=t.errorMsg;switch(n){case"FETCH_NEWS_REQUEST":return Object(l.a)({},e,{status:h.REQUEST,errorMsg:null});case"FETCH_NEWS_SUCCESS":return Object(l.a)({},e,{status:h.SUCCESS,news:r,errorMsg:null});case"FETCH_NEWS_FAILURE":return Object(l.a)({},e,{status:h.FAILURE,errorMsg:a});default:return e}},N=Object(s.c)({menu:p,login:I,news:L}),U=function(e){var t=e.getState;return function(e){return function(n){return console.log(n.type),console.log(t()),e(n)}}};function R(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(a){return"function"===typeof a?a(n,r,e):t(a)}}}}var k=R();k.withExtraArgument=R;var x=n(15),A=n(17),F=n(23),M=n(22),P=n(24),H=n(354),G=n(49),Q=(n(202),n(203),function(){return a.a.createElement("h2",null,"IndexPage")}),W=n(6),D=n.n(W),X=n(360),q=n(355),K=n(358),J=(n(204),n(205),function(){return a.a.createElement("div",null,"Error!")}),V=function(e){function t(){var e,n;Object(x.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(M.a)(t)).call.apply(e,[this].concat(a)))).state={hasError:!1},n}return Object(P.a)(t,e),Object(A.a)(t,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?a.a.createElement(J,null):this.props.children}}]),t}(r.Component),B=(n(206),function(e){function t(){var e,n;Object(x.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(M.a)(t)).call.apply(e,[this].concat(a)))).state={renderError:!1},n}return Object(P.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this;return this.state.renderError&&(this.foo.bar=0),a.a.createElement("button",{className:"error-button btn btn-danger btn-lg",onClick:function(){return e.setState({renderError:!0})}},"Throw Error")}}]),t}(r.Component));D.a.LoginPage={onLogin:D.a.func.isRequired,isLoggedIn:D.a.bool.isRequired};var z=function(e){var t=e.userNameText,n=e.passwordText,o=e.onUsernameChange,c=e.onPasswordChange,u=e.errorMsg,i=e.onLogin,s=!(t&&n),l=u?a.a.createElement("div",null,u):null;return a.a.createElement(r.Fragment,null,a.a.createElement(B,null),a.a.createElement(X.a,null,a.a.createElement(q.a,{onSubmit:function(){i()}},a.a.createElement(q.a.Group,{widths:"equal"},a.a.createElement(q.a.Input,{fluid:!0,label:"Username",placeholder:"username",onChange:function(e){var t=e.nativeEvent.data;o(t)},value:t}),a.a.createElement(q.a.Input,{fluid:!0,label:"Password",placeholder:"password",onChange:function(e){var t=e.nativeEvent.data;c(t)},value:n})),a.a.createElement(K.a,{type:"submit",disabled:s},"Submit")),l))},Y=(n(323),n(357)),Z=n(356),$=(n(324),function(e){var t=e.urlToImage,n=e.title,o=e.description;return a.a.createElement(r.Fragment,null,a.a.createElement(X.a,null,a.a.createElement(Y.a,{style:{width:"100%"}},a.a.createElement(Y.a.Content,null,a.a.createElement(Z.a,null,a.a.createElement(Z.a.Event,null,a.a.createElement(Z.a.Label,{image:t,style:{width:"100px"}}),a.a.createElement(Z.a.Content,null,a.a.createElement(Z.a.Summary,null,o),a.a.createElement(Z.a.Date,{content:n}))))))))}),ee=function(e){var t=e.news,n=e.errorMsg,o=n?a.a.createElement("div",null,n):null,c=t.map(function(e,t){return a.a.createElement($,Object.assign({key:t},e))});return a.a.createElement(r.Fragment,null,o,c)},te=(n(326),function(){return a.a.createElement("h2",null,"ProfilePage")}),ne=n(62),re=n(359),ae=(n(327),function(e){var t=e.onChange,n=e.location,r=e.menuList,o=n.pathname,c=r.map(function(e){var n=e.id,r=e.to,c=e.content;return a.a.createElement(u.b,{key:n,to:r,onClick:function(){return function(e){t(e)}(o)}},a.a.createElement(re.a.Item,{content:c,active:o===r}))});return a.a.createElement(re.a,null,c)}),oe=(n(344),function(){return a.a.createElement("div",null,"loading...")}),ce=function(){return function(e){return function(t){return a.a.createElement(j,null,function(n){return a.a.createElement(e,Object.assign({},t,{authService:n}))})}}},ue=function(){return function(e){return function(t){return a.a.createElement(w,null,function(n){return a.a.createElement(e,Object.assign({},t,{newsapiService:n}))})}}},ie=function(e){function t(){return Object(x.a)(this,t),Object(F.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this.props,t=e.status,n=e.isLoggedIn,r=Object(ne.a)(e,["status","isLoggedIn"]);return t===h.REQUEST?a.a.createElement(oe,null):n?a.a.createElement(G.a,{to:"/profile"}):a.a.createElement(z,r)}}]),t}(r.Component),se=ce()(Object(i.b)(function(e){var t=e.login;return Object(l.a)({},t)},function(e,t){var n,r=t.authService;return Object(s.b)({onUsernameChange:E,onPasswordChange:f,onLogin:(n=r,function(){return function(e,t){var r=t().login,a=r.userNameText,o=r.passwordText;e({type:"FETCH_LOGIN_REQUEST"}),n.tryLogin(a,o).then(function(t){var n=t.status,r=t.message;"ok"===n?(localStorage.setItem("token",!0),e(m())):"err"===n&&e(g(r))}).catch(function(t){return e(g(t.message))})}})},e)})(ie)),le=function(e){function t(){return Object(x.a)(this,t),Object(F.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.news,n=e.getNews;0===t.length&&n()}},{key:"render",value:function(){var e=this.props,t=e.status,n=e.news,r=e.errorMsg;return t===h.REQUEST?a.a.createElement(oe,null):a.a.createElement(ee,{news:n,errorMsg:r})}}]),t}(r.Component),Ee=ue()(Object(i.b)(function(e){var t=e.news;return Object(l.a)({},t)},function(e,t){var n,r=t.newsapiService;return Object(s.b)({getNews:(n=r,function(){return function(e){e({type:"FETCH_NEWS_REQUEST"}),n.getResourse().then(function(t){var n=t.status,r=t.articles;"ok"===n?e({type:"FETCH_NEWS_SUCCESS",news:r}):"err"===n&&e(b("\u0414\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u044b")),console.log("fetchNews",r)}).catch(function(t){return e(b(t.message))})}})},e)})(le)),fe=function(e){function t(){return Object(x.a)(this,t),Object(F.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isLoggedIn,n=Object(ne.a)(e,["isLoggedIn"]);return t?a.a.createElement(te,n):a.a.createElement(G.a,{to:"/login"})}}]),t}(r.Component),me=Object(i.b)(function(e){return{isLoggedIn:e.login.isLoggedIn}})(fe),ge=function(e){function t(){return Object(x.a)(this,t),Object(F.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){this.props.logout()}},{key:"render",value:function(){return a.a.createElement(G.a,{to:"/"})}}]),t}(r.Component),be={logout:function(){return function(e){localStorage.removeItem("token"),e({type:"LOGOUT"})}}},de=Object(i.b)(null,be)(ge),pe=[{id:1,to:"/",content:"\u041d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e"},{id:2,to:"/news",content:"\u041d\u043e\u0432\u043e\u0441\u0442\u0438"},{id:3,to:"/profile",content:"\u041f\u0440\u043e\u0444\u0430\u0439\u043b"},{id:4,to:"/login",content:"\u041b\u043e\u0433\u0438\u043d"}],he=[{id:1,to:"/",content:"\u041d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e"},{id:2,to:"/news",content:"\u041d\u043e\u0432\u043e\u0441\u0442\u0438"},{id:3,to:"/profile",content:"\u041f\u0440\u043e\u0444\u0430\u0439\u043b"},{id:4,to:"/logout",content:"\u0412\u044b\u0445\u043e\u0434"}],Oe=function(e){function t(){return Object(x.a)(this,t),Object(F.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isLoggedIn,n=Object(ne.a)(e,["isLoggedIn"]),r=t?he:pe;return a.a.createElement(ae,Object.assign({},n,{menuList:r}))}}]),t}(r.Component),ve=Object(i.b)(function(e){return{activePage:e.menu.activePage,isLoggedIn:e.login.isLoggedIn}},function(e){return{onChange:function(t){return e(function(e){return{type:"CHANGE_ACTIVE_PAGE",page:e}}(t))}}})(Object(G.f)(Oe)),je=function(e){function t(){return Object(x.a)(this,t),Object(F.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){this.props.autoLogin()}},{key:"render",value:function(){return a.a.createElement(H.a,{className:"top"},a.a.createElement(ve,null),a.a.createElement(G.d,null,a.a.createElement(G.b,{path:"/",exact:!0,render:function(){return a.a.createElement(Q,null)}}),a.a.createElement(G.b,{path:"/news",render:function(){return a.a.createElement(Ee,null)}}),a.a.createElement(G.b,{path:"/profile",render:function(){return a.a.createElement(me,null)}}),a.a.createElement(G.b,{path:"/login",render:function(){return a.a.createElement(se,null)}}),a.a.createElement(G.b,{path:"/logout",render:function(){return a.a.createElement(de,null)}}),a.a.createElement(G.b,{render:function(){return a.a.createElement("h2",null,"Page not found")}})))}}]),t}(r.Component),Ce={autoLogin:function(){return function(e){localStorage.getItem("token")&&e(m())}}},Se=Object(i.b)(null,Ce)(je),we=function(){function e(){Object(x.a)(this,e)}return Object(A.a)(e,[{key:"tryLogin",value:function(e,t){return new Promise(function(n,r){setTimeout(function(){Math.random()>.8?r(new Error("Network Error")):n("1"===e&&"1"===t?{status:"ok",data:{id:1}}:{status:"err",message:"wrong_email_or_password"})},1200)})}}]),e}(),Te=n(117),ye=n.n(Te),Ie=n(180),_e=Object(s.d)(N,Object(s.a)(k,U)),Le=new we,Ne=new function e(){var t=this;Object(x.a)(this,e),this._baseUrl="https://newsapi.org/v2/",this._apiKey="7fd45e35dc9349c8ad721a77101089d6",this.getResourse=Object(Ie.a)(ye.a.mark(function e(){var n,r;return ye.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t._baseUrl,"top-headlines?sources=bbc-news&apiKey=").concat(t._apiKey));case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Could not fetch ".concat(t._baseUr,", resived ").concat(n.status));case 5:return e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",r);case 9:case"end":return e.stop()}},e)}))};c.a.render(a.a.createElement(i.a,{store:_e},a.a.createElement(V,null,a.a.createElement(u.a,null,a.a.createElement(v,{value:Le},a.a.createElement(S,{value:Ne},a.a.createElement(Se,null)))))),document.getElementById("root"))}},[[192,1,2]]]);
//# sourceMappingURL=main.6e50ab1e.chunk.js.map