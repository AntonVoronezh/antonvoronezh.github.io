(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{202:function(e,t,n){e.exports=n(374)},214:function(e,t,n){},215:function(e,t,n){},216:function(e,t,n){},217:function(e,t,n){},218:function(e,t,n){},335:function(e,t,n){},336:function(e,t,n){},338:function(e,t,n){},339:function(e,t,n){},356:function(e,t,n){},374:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(43),o=n.n(c),u=n(42),i=n(27),s=(n(211),n(30)),l=n(15),E=n(28),f=n.n(E),p=n(44),m=function(e){return{type:"CHANGE_USERNAME_TEXT",text:e}},g=function(e){return{type:"CHANGE_PASSWORD_TEXT",text:e}},d=function(e){return{type:"FETCH_LOGIN_SUCCESS",data:e}},b=function(e){return{type:"FETCH_LOGIN_FAILURE",errorMsg:e}},h=function(e){return{type:"FETCH_NEWS_FAILURE",errorMsg:e}},v=function(e){return{type:"ADD_PROFILE_ID",id:e}},O=function(e){return{type:"FETCH_PROFILE_FAILURE",errorMsg:e}},j={activePage:"/"},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_ACTIVE_PAGE":return Object(l.a)({},e,{activePage:t.page});default:return e}},C={INIT:"INIT",SUCCESS:"SUCCESS",FAILURE:"FAILURE",REQUEST:"REQUEST",ERROR:"ERROR"},I=a.a.createContext(),y=I.Provider,T=I.Consumer,w=a.a.createContext(),_=w.Provider,L=w.Consumer,R={userNameText:"",passwordText:"",status:C.INIT,isLoggedIn:!1,errorMsg:null},U=function(e,t){return null===t?e.slice(0,e.length-1):e+t},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.text,a=t.errorMsg,c=e.userNameText,o=e.passwordText;switch(n){case"CHANGE_USERNAME_TEXT":return Object(l.a)({},e,{userNameText:U(c,r)});case"CHANGE_PASSWORD_TEXT":return Object(l.a)({},e,{passwordText:U(o,r)});case"FETCH_LOGIN_REQUEST":return Object(l.a)({},e,{status:C.REQUEST,errorMsg:null});case"FETCH_LOGIN_SUCCESS":return Object(l.a)({},e,{status:C.SUCCESS,userNameText:"",passwordText:"",isLoggedIn:!0,errorMsg:null});case"FETCH_LOGIN_FAILURE":return Object(l.a)({},e,{status:C.FAILURE,errorMsg:a,userNameText:"",passwordText:""});case"LOGOUT":return Object(l.a)({},e,{status:C.INIT,isLoggedIn:!1});default:return e}},x={news:[],status:C.INIT,errorMsg:null},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.news,a=t.errorMsg;switch(n){case"FETCH_NEWS_REQUEST":return Object(l.a)({},e,{status:C.REQUEST,errorMsg:null});case"FETCH_NEWS_SUCCESS":return Object(l.a)({},e,{status:C.SUCCESS,news:r,errorMsg:null});case"FETCH_NEWS_FAILURE":return Object(l.a)({},e,{status:C.FAILURE,errorMsg:a});default:return e}},N={id:null,status:C.INIT,profile:null,errorMsg:null},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.id,a=t.profile,c=t.errorMsg;switch(n){case"ADD_PROFILE_ID":return Object(l.a)({},e,{id:r});case"FETCH_PROFILE_REQUEST":return{status:C.REQUEST,errorMsg:null};case"FETCH_PROFILE_SUCCESS":return Object(l.a)({},e,{status:C.SUCCESS,profile:a,errorMsg:null});case"FETCH_PROFILE_FAILURE":return Object(l.a)({},e,{status:C.FAILURE,errorMsg:c});default:return e}},M=Object(s.c)({menu:S,login:k,news:F,profile:A}),P=function(e){var t=e.getState;return function(e){return function(n){return console.log(n.type),console.log(t()),e(n)}}};function H(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(a){return"function"===typeof a?a(n,r,e):t(a)}}}}var G=H();G.withExtraArgument=H;var D=n(16),Q=n(21),W=n(23),X=n(22),q=n(24),J=n(381),K=n(53),V=(n(214),n(215),function(){return a.a.createElement("h2",null,"IndexPage")}),z=n(6),B=n.n(z),Y=n(387),Z=n(382),$=n(386),ee=(n(216),n(217),function(){return a.a.createElement("div",null,"Error!")}),te=function(e){function t(){var e,n;Object(D.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(W.a)(this,(e=Object(X.a)(t)).call.apply(e,[this].concat(a)))).state={hasError:!1},n}return Object(q.a)(t,e),Object(Q.a)(t,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?a.a.createElement(ee,null):this.props.children}}]),t}(r.Component),ne=(n(218),function(e){function t(){var e,n;Object(D.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(W.a)(this,(e=Object(X.a)(t)).call.apply(e,[this].concat(a)))).state={renderError:!1},n}return Object(q.a)(t,e),Object(Q.a)(t,[{key:"render",value:function(){var e=this;return this.state.renderError&&(this.foo.bar=0),a.a.createElement("button",{className:"error-button btn btn-danger btn-lg",onClick:function(){return e.setState({renderError:!0})}},"Throw Error")}}]),t}(r.Component));B.a.LoginPage={onLogin:B.a.func.isRequired,isLoggedIn:B.a.bool.isRequired};var re=function(e){var t=e.userNameText,n=e.passwordText,c=e.onUsernameChange,o=e.onPasswordChange,u=e.errorMsg,i=e.onLogin,s=!(t&&n),l=u?a.a.createElement("div",null,u):null;return a.a.createElement(r.Fragment,null,a.a.createElement(ne,null),a.a.createElement(Y.a,null,a.a.createElement(Z.a,{onSubmit:function(){i()}},a.a.createElement(Z.a.Group,{widths:"equal"},a.a.createElement(Z.a.Input,{fluid:!0,label:"Username",placeholder:"username",onChange:function(e){var t=e.nativeEvent.data;c(t)},value:t}),a.a.createElement(Z.a.Input,{fluid:!0,label:"Password",placeholder:"password",onChange:function(e){var t=e.nativeEvent.data;o(t)},value:n})),a.a.createElement($.a,{type:"submit",disabled:s},"Submit")),l))},ae=(n(335),n(384)),ce=n(383),oe=(n(336),function(e){var t=e.urlToImage,n=e.title,c=e.description;return a.a.createElement(r.Fragment,null,a.a.createElement(Y.a,null,a.a.createElement(ae.a,{style:{width:"100%"}},a.a.createElement(ae.a.Content,null,a.a.createElement(ce.a,null,a.a.createElement(ce.a.Event,null,a.a.createElement(ce.a.Label,{image:t,style:{width:"100px"}}),a.a.createElement(ce.a.Content,null,a.a.createElement(ce.a.Summary,null,c),a.a.createElement(ce.a.Date,{content:n}))))))))}),ue=function(e){var t=e.news,n=e.errorMsg,c=n?a.a.createElement("div",null,n):null,o=t.map(function(e,t){return a.a.createElement(oe,Object.assign({key:t},e))});return a.a.createElement(r.Fragment,null,c,o)},ie=n(67);n(338);function se(e){var t=e.id,n=e.label,r=e.link;return a.a.createElement("li",{key:t},n," -"," ",a.a.createElement("a",{href:r},a.a.createElement(ie.a,{name:"home",size:"small"})))}var le=function(e){var t,n,c=e.profile,o=e.errorMsg,u=null;if(c){var i=c.city,s=c.languages,l=c.social;t=a.a.createElement("div",null,"\u0413\u043e\u0440\u043e\u0434: ",i),n=s.map(function(e,t){return a.a.createElement("li",{key:t},e)}),n=a.a.createElement("div",null,"\u0417\u043d\u0430\u043d\u0438\u0435 \u044f\u0437\u044b\u043a\u043e\u0432: ",a.a.createElement("ul",null,n)),u=l.map(function(e,t){var n=e.label,r=e.link;return a.a.createElement(se,{key:t,id:t,link:r,label:n})})}var E=o?a.a.createElement("div",null,o):null;return a.a.createElement(r.Fragment,null,a.a.createElement("h2",null,"ProfilePage"),t,n,u,E)},Ee=n(52),fe=n(385),pe=(n(339),function(e){var t=e.onChange,n=e.location,r=e.menuList,c=n.pathname,o=r.map(function(e){var n=e.id,r=e.to,o=e.content;return a.a.createElement(u.b,{key:n,to:r,onClick:function(){return function(e){t(e)}(c)}},a.a.createElement(fe.a.Item,{content:o,active:c===r}))});return a.a.createElement(fe.a,null,o)}),me=(n(356),function(){return a.a.createElement("div",null,"loading...")}),ge=function(){return function(e){return function(t){return a.a.createElement(T,null,function(n){return a.a.createElement(e,Object.assign({},t,{authService:n}))})}}},de=function(){return function(e){return function(t){return a.a.createElement(L,null,function(n){return a.a.createElement(e,Object.assign({},t,{newsapiService:n}))})}}},be=function(e){function t(){return Object(D.a)(this,t),Object(W.a)(this,Object(X.a)(t).apply(this,arguments))}return Object(q.a)(t,e),Object(Q.a)(t,[{key:"render",value:function(){var e=this.props,t=e.status,n=e.isLoggedIn,r=Object(Ee.a)(e,["status","isLoggedIn"]);return t===C.REQUEST?a.a.createElement(me,null):n?a.a.createElement(K.a,{to:"/profile"}):a.a.createElement(re,r)}}]),t}(r.Component),he=ge()(Object(i.b)(function(e){var t=e.login;return Object(l.a)({},t)},function(e,t){var n,r=t.authService;return Object(s.b)({onUsernameChange:m,onPasswordChange:g,onLogin:(n=r,function(){return function(){var e=Object(p.a)(f.a.mark(function e(t,r){var a,c,o,u,i,s,l,E;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r(),c=a.login,o=c.userNameText,u=c.passwordText,t({type:"FETCH_LOGIN_REQUEST"}),e.prev=2,e.next=5,n.tryLogin(o,u);case 5:i=e.sent,s=i.status,l=i.message,E=i.data.id,"ok"===s?(localStorage.setItem("token",!0),localStorage.setItem("id",E),t(d()),t(v(E))):"err"===s&&t(b(l)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),t(b(e.t0.message));case 13:case"end":return e.stop()}},e,null,[[2,10]])}));return function(t,n){return e.apply(this,arguments)}}()})},e)})(be)),ve=function(e){function t(){return Object(D.a)(this,t),Object(W.a)(this,Object(X.a)(t).apply(this,arguments))}return Object(q.a)(t,e),Object(Q.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.news,n=e.getNews;0===t.length&&n()}},{key:"render",value:function(){var e=this.props,t=e.status,n=e.news,r=e.errorMsg;return t===C.REQUEST?a.a.createElement(me,null):a.a.createElement(ue,{news:n,errorMsg:r})}}]),t}(r.Component),Oe=de()(Object(i.b)(function(e){var t=e.news;return Object(l.a)({},t)},function(e,t){var n,r=t.newsapiService;return Object(s.b)({getNews:(n=r,function(){return function(e){e({type:"FETCH_NEWS_REQUEST"}),n.getResourse().then(function(t){var n=t.status,r=t.articles;"ok"===n?e({type:"FETCH_NEWS_SUCCESS",news:r}):"err"===n&&e(h("\u0414\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u044b")),console.log("fetchNews",r)}).catch(function(t){return e(h(t.message))})}})},e)})(ve)),je=function(e){function t(){return Object(D.a)(this,t),Object(W.a)(this,Object(X.a)(t).apply(this,arguments))}return Object(q.a)(t,e),Object(Q.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.profile.id,n=e.fetchProfile;t&&n(t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.profile.id,r=t.fetchProfile;e.id!==n&&r(n)}},{key:"render",value:function(){var e=this.props,t=e.isLoggedIn,n=e.profile,r=n.status,c=Object(Ee.a)(n,["status"]);Object(Ee.a)(e,["isLoggedIn","profile"]);return t?r===C.REQUEST?a.a.createElement(me,null):a.a.createElement(le,c):a.a.createElement(K.a,{to:"/login"})}}]),t}(r.Component),Se=ge()(Object(i.b)(function(e){return{isLoggedIn:e.login.isLoggedIn,profile:e.profile}},function(e,t){var n,r=t.authService;return Object(s.b)({fetchProfile:(n=r,function(){return function(){var e=Object(p.a)(f.a.mark(function e(t,r){var a,c,o,u,i,s;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r(),c=a.profile.id,t({type:"FETCH_PROFILE_REQUEST"}),e.prev=2,e.next=5,n.getUser(c);case 5:o=e.sent,u=o.status,i=o.message,s=o.data,"ok"===u?t({type:"FETCH_PROFILE_SUCCESS",profile:s}):"err"===u&&t(O(i)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),t(O(e.t0.message));case 13:case"end":return e.stop()}},e,null,[[2,10]])}));return function(t,n){return e.apply(this,arguments)}}()})},e)})(je)),Ce=function(e){function t(){return Object(D.a)(this,t),Object(W.a)(this,Object(X.a)(t).apply(this,arguments))}return Object(q.a)(t,e),Object(Q.a)(t,[{key:"componentDidMount",value:function(){this.props.logout()}},{key:"render",value:function(){return a.a.createElement(K.a,{to:"/"})}}]),t}(r.Component),Ie={logout:function(){return function(e){localStorage.removeItem("token"),localStorage.removeItem("id"),e({type:"LOGOUT"})}}},ye=Object(i.b)(null,Ie)(Ce),Te=[{id:1,to:"/",content:"\u041d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e"},{id:2,to:"/news",content:"\u041d\u043e\u0432\u043e\u0441\u0442\u0438"},{id:3,to:"/profile",content:"\u041f\u0440\u043e\u0444\u0430\u0439\u043b"},{id:4,to:"/login",content:"\u041b\u043e\u0433\u0438\u043d"}],we=[{id:1,to:"/",content:"\u041d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e"},{id:2,to:"/news",content:"\u041d\u043e\u0432\u043e\u0441\u0442\u0438"},{id:3,to:"/profile",content:"\u041f\u0440\u043e\u0444\u0430\u0439\u043b"},{id:4,to:"/logout",content:"\u0412\u044b\u0445\u043e\u0434"}],_e=function(e){function t(){return Object(D.a)(this,t),Object(W.a)(this,Object(X.a)(t).apply(this,arguments))}return Object(q.a)(t,e),Object(Q.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isLoggedIn,n=Object(Ee.a)(e,["isLoggedIn"]),r=t?we:Te;return a.a.createElement(pe,Object.assign({},n,{menuList:r}))}}]),t}(r.Component),Le=Object(i.b)(function(e){return{activePage:e.menu.activePage,isLoggedIn:e.login.isLoggedIn}},function(e){return{onChange:function(t){return e(function(e){return{type:"CHANGE_ACTIVE_PAGE",page:e}}(t))}}})(Object(K.f)(_e)),Re=function(e){function t(){return Object(D.a)(this,t),Object(W.a)(this,Object(X.a)(t).apply(this,arguments))}return Object(q.a)(t,e),Object(Q.a)(t,[{key:"componentDidMount",value:function(){this.props.autoLogin()}},{key:"render",value:function(){return a.a.createElement(J.a,{className:"top"},a.a.createElement(Le,null),a.a.createElement(K.d,null,a.a.createElement(K.b,{path:"/",exact:!0,render:function(){return a.a.createElement(V,null)}}),a.a.createElement(K.b,{path:"/news",render:function(){return a.a.createElement(Oe,null)}}),a.a.createElement(K.b,{path:"/profile",render:function(){return a.a.createElement(Se,null)}}),a.a.createElement(K.b,{path:"/login",render:function(){return a.a.createElement(he,null)}}),a.a.createElement(K.b,{path:"/logout",render:function(){return a.a.createElement(ye,null)}}),a.a.createElement(K.b,{render:function(){return a.a.createElement("h2",null,"Page not found")}})))}}]),t}(r.Component),Ue={autoLogin:function(){return function(e){if(localStorage.getItem("token")){var t=localStorage.getItem("id");e(v(t)),e(d())}}}},ke=Object(i.b)(null,Ue)(Re),xe=n(190),Fe=n.n(xe),Ne=Object(s.d)(M,Object(s.a)(G,P)),Ae=new function e(){var t=this;Object(D.a)(this,e),this._axiosInstance=Fe.a.create({baseURL:"https://mysterious-reef-29460.herokuapp.com/api/v1/",headers:{"content-type":" application/json"}}),this._getResourse=function(e,t){if(200===!e.status)throw new Error("Could not fetch ".concat(t,", resived ").concat(e.status));return e.data},this.tryLogin=function(){var e=Object(p.a)(f.a.mark(function e(n,r){var a,c,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="validate",c=JSON.stringify({email:n,password:r}),e.next=4,t._axiosInstance.post(a,c);case 4:return o=e.sent,e.abrupt("return",t._getResourse(o,a));case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),this.getUser=function(){var e=Object(p.a)(f.a.mark(function e(n){var r,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="user-info/".concat(n),e.next=3,t._axiosInstance.get(r);case 3:return a=e.sent,e.abrupt("return",t._getResourse(a,r));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Me=new function e(){var t=this;Object(D.a)(this,e),this._baseUrl="https://newsapi.org/v2/",this._apiKey="7fd45e35dc9349c8ad721a77101089d6",this.getResourse=Object(p.a)(f.a.mark(function e(){var n,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t._baseUrl,"top-headlines?sources=bbc-news&apiKey=").concat(t._apiKey));case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Could not fetch ".concat(t._baseUr,", resived ").concat(n.status));case 5:return e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",r);case 9:case"end":return e.stop()}},e)}))};o.a.render(a.a.createElement(i.a,{store:Ne},a.a.createElement(te,null,a.a.createElement(u.a,null,a.a.createElement(y,{value:Ae},a.a.createElement(_,{value:Me},a.a.createElement(ke,null)))))),document.getElementById("root"))}},[[202,1,2]]]);
//# sourceMappingURL=main.1518abbb.chunk.js.map